{
  "openapi": "3.0.0",
  "info": {
    "title": "StuReflect Backend API",
    "version": "1.0.0",
    "description": "Volledige API-documentatie voor StuReflect backend. Deze API biedt volledige ondersteuning voor authenticatie met JWT-tokens, gebruikersbeheer, cursusbeheer. Alle endpoints ondersteunen JSON request/response format.",
    "contact": {
      "name": "API Ondersteuning",
      "email": "support@stureflect.com"
    },
    "license": {
      "name": "MIT"
    }
  },
  "servers": [
    {
      "url": "https://stureflect-backend-api.vercel.app",
      "description": "Productieserver"
    },
    {
      "url": "http://localhost:3000",
      "description": "Ontwikkelingserver"
    }
  ],
  "tags": [
    {
      "name": "Algemeen",
      "description": "Algemene endpoints voor API-gezondheid en informatie"
    },
    {
      "name": "Authenticatie",
      "description": "Endpoints voor gebruiker registratie en inloggen met JWT-authenticatie"
    },
    {
      "name": "Cursussen",
      "description": "Endpoints voor cursusbeheer en cursusgegevens"
    }
  ],
  "paths": {
    "/": {
      "get": {
        "summary": "Controleert of de API beschikbaar is",
        "description": "Dit endpoint retourneert een welkomstbericht en kan gebruikt worden om te verifiÃ«ren dat de API online en beschikbaar is. Dit is handig voor health checks en monitoring.",
        "operationId": "getRootMessage",
        "tags": [
          "Algemeen"
        ],
        "responses": {
          "200": {
            "description": "De API is beschikbaar en retourneert welkomstbericht",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string",
                  "example": "Hallo vanuit Express op Vercel!"
                }
              }
            }
          }
        }
      }
    },
    "/api/auth/login": {
      "post": {
        "summary": "Gebruiker inloggen",
        "description": "Authenticeert een gebruiker met emailadres en wachtwoord. Bij succesvol inloggen wordt een JWT-token geretourneerd dat 1 uur geldig is. Dit token moet gebruikt worden in de Authorization header voor alle beveiligde endpoints. Het token moet in het formaat 'Bearer <token>' meegegeven worden.",
        "operationId": "loginUser",
        "tags": [
          "Authenticatie"
        ],
        "requestBody": {
          "required": true,
          "description": "Gebruiker inloggegevens vereist",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {
                    "type": "string",
                    "format": "email",
                    "example": "gebruiker@voorbeeld.nl",
                    "description": "Geregistreerd emailadres van de gebruiker. Dit emailadres moet exact overeenkomen met het ingeregistreerde adres."
                  },
                  "password": {
                    "type": "string",
                    "format": "password",
                    "example": "VeiligWachtwoord123!",
                    "description": "Wachtwoord van de gebruiker (minimaal 6 tekens). Wachtwoorden zijn case-sensitief."
                  }
                },
                "required": [
                  "email",
                  "password"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Succesvol ingelogd - JWT-tokens ontvangen",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "accessToken": {
                      "type": "string",
                      "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiZW1haWwiOiJnZWJydWlrZXJAZm9vcmJlZWxkLm5sIiwicm9sZSI6InN0dWRlbnQiLCJpYXQiOjE2OTI4MDAwMDAsImV4cCI6MTY5MjgwMzYwMH0.signature",
                      "description": "JWT access token met 15 minuten geldigheid (15m). Gebruik dit in Authorization header."
                    },
                    "refreshToken": {
                      "type": "string",
                      "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiZW1haWwiOiJnZWJydWlrZXJAZm9vcmJlZWxkLm5sIiwiaWF0IjoxNjkyODAwMDAwLCJleHAiOjE3MDA1ODAwMDB9.signature",
                      "description": "Refresh token met 7 dagen geldigheid. Gebruik dit om een nieuw access token op te vragen via /api/auth/refresh."
                    },
                    "user": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "integer",
                          "example": 1,
                          "description": "Gebruiker ID"
                        },
                        "email": {
                          "type": "string",
                          "example": "gebruiker@voorbeeld.nl",
                          "description": "Gebruiker email"
                        },
                        "name": {
                          "type": "string",
                          "example": "Jan Jansen",
                          "description": "Gebruiker naam"
                        },
                        "role": {
                          "type": "string",
                          "example": "student",
                          "description": "Gebruiker rol (student, docent, beheerder)"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Ongeldig verzoek - emailadres of wachtwoord ontbreekt",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Emailadres en wachtwoord zijn verplicht."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Gebruiker niet gevonden",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Gebruiker met dit emailadres is niet geregistreerd."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Ongeldige inloggegevens - wachtwoord is onjuist",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Het ingevoerde wachtwoord is onjuist."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Interne serverfout",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Er is iets misgegaan bij het verwerken van uw verzoek."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/auth/register": {
      "post": {
        "summary": "Nieuw gebruikersaccount aanmaken",
        "description": "Registreert een nieuwe gebruiker in het systeem. Het wachtwoord wordt veilig versleuteld opgeslagen met bcrypt. Na succesvolle registratie kan de gebruiker inloggen met het loginendpoint. Elk emailadres kan slechts eenmaal gebruikt worden.",
        "operationId": "registerUser",
        "tags": [
          "Authenticatie"
        ],
        "requestBody": {
          "required": true,
          "description": "Registratiegegevens voor nieuwe gebruiker",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {
                    "type": "string",
                    "format": "email",
                    "example": "nieuwegebruiker@voorbeeld.nl",
                    "description": "Uniek emailadres voor het nieuwe account. Dit emailadres mag niet al in het systeem geregistreerd zijn."
                  },
                  "name": {
                    "type": "string",
                    "example": "Jan Jansen",
                    "description": "Volledige naam van de gebruiker. Dit wordt gebruikt voor weergave in het systeem."
                  },
                  "password": {
                    "type": "string",
                    "format": "password",
                    "example": "VeiligWachtwoord123!",
                    "description": "Wachtwoord van minimaal 6 tekens. Gebruik minimaal een mix van hoofdletters, kleine letters en nummers voor extra veiligheid."
                  },
                  "role": {
                    "type": "string",
                    "enum": [
                      "student",
                      "docent",
                      "beheerder"
                    ],
                    "example": "student",
                    "description": "Optioneel: gebruikersrol in het systeem. Standaard is 'student'. Beschikbare rollen: student, docent, beheerder."
                  }
                },
                "required": [
                  "email",
                  "name",
                  "password"
                ]
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Gebruiker succesvol aangemaakt",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "integer",
                      "example": 15,
                      "description": "Unieke gebruiker ID in het systeem"
                    },
                    "email": {
                      "type": "string",
                      "example": "nieuwegebruiker@voorbeeld.nl",
                      "description": "Geregistreerd emailadres van de nieuwe gebruiker"
                    },
                    "name": {
                      "type": "string",
                      "example": "Jan Jansen",
                      "description": "Volledige naam van de gebruiker"
                    },
                    "role": {
                      "type": "string",
                      "example": "student",
                      "description": "Toegewezen rol van de gebruiker (standaard: student)"
                    },
                    "github_id": {
                      "type": "null",
                      "example": null,
                      "description": "GitHub ID (null bij normaal registratie)"
                    },
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "example": "2024-12-10T10:30:00Z",
                      "description": "Aanmaakdatum van het account"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Ongeldig verzoek - email of naam of wachtwoord ontbreekt, of email al in gebruik",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "E-mailadres, naam en wachtwoord zijn verplicht."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Interne serverfout",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Er is iets misgegaan bij het registreren van de gebruiker."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/auth/refresh": {
      "post": {
        "summary": "Token vernieuwen",
        "description": "Vernieuwt zowel access token als refresh token. Dit endpoint moet gebruikt worden als het access token verlopen is (na 15 minuten). Retourneert een nieuw access token (15 min geldig) en een nieuw refresh token (7 dagen geldig).",
        "operationId": "refreshToken",
        "tags": [
          "Authenticatie"
        ],
        "requestBody": {
          "required": true,
          "description": "Refresh token vereist",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "refreshToken": {
                    "type": "string",
                    "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiZW1haWwiOiJnZWJydWlrZXJAZm9vcmJlZWxkLm5sIiwiaWF0IjoxNjkyODAwMDAwLCJleHAiOjE3MDA1ODAwMDB9.signature",
                    "description": "Refresh token ontvangen bij login"
                  }
                },
                "required": [
                  "refreshToken"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Tokens succesvol vernieuwd",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "accessToken": {
                      "type": "string",
                      "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiZW1haWwiOiJnZWJydWlrZXJAZm9vcmJlZWxkLm5sIiwicm9sZSI6InN0dWRlbnQiLCJpYXQiOjE2OTI4MDAwMDAsImV4cCI6MTY5MjgwMzYwMH0.signature",
                      "description": "Nieuw JWT access token (15 minuten geldig)"
                    },
                    "refreshToken": {
                      "type": "string",
                      "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiZW1haWwiOiJnZWJydWlrZXJAZm9vcmJlZWxkLm5sIiwiaWF0IjoxNjkyODAwMDAwLCJleHAiOjE3MDA1ODAwMDB9.signature",
                      "description": "Nieuw refresh token (7 dagen geldig)"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Refresh token ontbreekt",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Refresh token is verplicht."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Ongeldige of verlopen refresh token",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Ongeldig of verlopen refresh token."
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Refresh token signature is ongeldig",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Ongeldig refresh token."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Interne serverfout bij token vernieuwen",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Interne serverfout bij token vernieuwen."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/courses": {
      "get": {
        "summary": "Alle beschikbare cursussen ophalen",
        "description": "Retourneert een volledige lijst met alle beschikbare cursussen in het systeem. Elke cursus bevat zijn unieke ID, titel, beschrijving en deelcode. Dit endpoint biedt een overzicht van alle cursussen waar leerlingen zich bij kunnen aansluiten.",
        "operationId": "getAllCourses",
        "tags": [
          "Cursussen"
        ],
        "responses": {
          "200": {
            "description": "Cursussen succesvol opgehaald",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true,
                      "description": "Status van de request - true bij succes"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "integer"
                          },
                          "title": {
                            "type": "string"
                          },
                          "description": {
                            "type": "string"
                          },
                          "code": {
                            "type": "string"
                          }
                        }
                      },
                      "description": "Array met alle beschikbare cursussen"
                    },
                    "message": {
                      "type": "string",
                      "example": "5 cursussen gevonden",
                      "description": "Aanvullend bericht over het aantal gevonden cursussen"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Interne serverfout bij ophalen cursussen",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": false
                    },
                    "error": {
                      "type": "string",
                      "example": "Er is een fout opgetreden bij het ophalen van de cursussen uit de database"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "JWT Token authenticatie. BELANGRIJK: Voeg het token toe in de Authorization header, NIET in de request body. Format: 'Authorization: Bearer <uw_jwt_token>'. Verkrijg een token via POST /api/auth/login of POST /api/auth/register. Access token geldig voor 15 minuten, gebruik /api/auth/refresh om te vernieuwen."
      }
    }
  }
}